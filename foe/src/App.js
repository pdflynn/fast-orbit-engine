import React, { useState } from "react";
import { Canvas, useThree } from "@react-three/fiber";
import { OrbitControls, Stars } from "@react-three/drei";
import "./styles.css";
import Sphere from "./components/viewpane/Sphere";
import OrbitTrace from "./components/viewpane/OrbitTrace";
import Orbits from "./components/control-pane/Orbits";
import OrbitAnimation from "./components/viewpane/OrbitAnimation";

// dummy data. TODO: pull planetary radii from FOE backend API
const R_EARTH = 6.371;
const MINUTES_PER_SECOND = 10;

function App() {

  // Temporary hard-coded orbital parameters
  const [orbits, setOrbits] = useState([
    {
      id: 1,
      text: 'Circular, Zero-Inclination Orbit',
      semiMajorAxis: 8500,
      eccentricity: 0,
      inclination: 0,
      rightAscension: 0,
      argPeriapse: 0,
      trueAnomaly: 0,
    },
    {
      id: 2,
      text: 'Elliptical, Polar Orbit',
      semiMajorAxis: 10000,
      eccentricity: 0.5,
      inclination: 90,
      rightAscension: 0,
      argPeriapse: 0,
      trueAnomaly: 0,
    }
  ])

  const deleteOrbit = (id) => {
    setOrbits(orbits.filter((orbit) => orbit.id !== id))
  }



  // dummy data
  const x = [8.5, 8.483225142742208, 8.432977578531792, 8.349449353925824, 8.23296433087317, 8.083985524109792, 7.903105017691238, 7.691035518154655, 7.448611918683358, 7.176792108779304, 6.8766485346255575, 6.54936602886462, 6.1962363236431965, 5.8186352420138965, 5.418105227637741, 4.9961833355919, 4.554536578978672, 4.094916141372411, 3.6191366022354154, 3.129073432943804, 2.626661157232815, 2.1138810753607675, 1.5927565819082115, 1.0653474834679715, 0.533734065242198, 1.430146830889862e-05, -0.5337053213039574, -1.065318709507452, -1.5927278508876639, -2.1138514890963354, -2.626632773257258, -3.129047757618219, -3.61911434892361, -4.09489830581971, -4.5545219698539405, -4.996171475747522, -5.418103907589663, -5.818654098868253, -6.196241110409568, -6.549375345732053, -6.876662759203664, -7.176812216319047, -7.448638932548127, -7.691070315891238, -7.903149727980978, -8.084039971046503, -8.233027774888273, -8.349524478509602, -8.433071219206576, -8.48333744165394, -8.500125814620995, -8.483369804181839, -8.433134940951744, -8.349620036787277, -8.233154528945281, -8.084198049354432, -7.903338443651758, -7.691289494103308, -7.448887995395254, -7.177090520417652, -6.876969706801406, -6.549709941285531, -6.196602531469467, -5.819040185939436, -5.4185147358599695, -4.996606732548249, -4.5549800280605846, -4.095377586674371, -3.6196134252520387, -3.1295647961275495, -2.627165797976376, -2.11439888191153, -1.5932879126155632, -1.0658892046259627, -0.534284188268299, -0.0005707276870477945, 0.5331450325609447, 1.0647567555642432, 1.5921665035918822, 2.1132928930490884, 2.626079321047779, 3.12850213691058, 3.618578436905706, 4.094374283986085, 4.554011883479529, 4.995677265669965, 5.4176276307235804, 5.818197462715439, 6.195805011806945, 6.548961268547535, 6.876272126805483, 7.176445837189239, 7.448297623911522, 7.6907545251268905, 7.902859738523078, 8.08377603363243, 8.232789343758023, 8.34931163548819, 8.432882897089062, 8.48317342861689, 8.499984486805772];
  const y = [0.0, 0.5155332233867099, 1.0290322956705018, 1.5384708466013586, 2.0418376484290537, 2.5371459777691885, 3.0224414417601992, 3.4958092431954615, 3.9553809736801706, 4.399342393030349, 4.825942007081029, 5.233495681424922, 5.620394913272642, 5.985097157031225, 6.326210992919573, 6.6423366181665475, 6.932254204603075, 7.194813948007789, 7.428981737302112, 7.6338312991357675, 7.8085550009463605, 7.952459487850419, 8.064975318935566, 8.145664465504483, 8.194207405556936, 8.210411919256295, 8.194214180522936, 8.145678149819886, 8.064995403674114, 7.952484352947572, 7.808589083236853, 7.6338775539056485, 7.429039265520448, 7.1948826477414745, 6.932331801090656, 6.642422903001693, 6.326300122280834, 5.985210951673238, 5.620501227795514, 5.233610972005205, 4.826066506234161, 4.3994766103467216, 3.9555245710850273, 3.4959624726841096, 3.0226040587817753, 2.5373171567582005, 2.0420172712897404, 1.5386586610090887, 1.0292281501470841, 0.5157358375062097, 0.00020841901472961762, -0.515319729648985, -1.0288143217275951, -1.53824879074104, -2.0416127901891055, -2.5369198518457488, -3.0222153560133864, -3.4955840651278187, -3.9551580476760915, -4.399123668924535, -4.825728807309623, -5.233289917708265, -5.620198795629156, -5.984929232807993, -6.326039826475455, -6.642184000218379, -6.932116876939824, -7.194693238717723, -7.4288770137952005, -7.633743532402922, -7.8084845915681775, -7.952410187947974, -8.064952778570312, -8.145667758531792, -8.19423705285171, -8.210468772549227, -8.19429848932031, -8.145790247329472, -8.065135368704166, -7.952652073329324, -7.8087842474488145, -7.63409958853011, -7.429287432998623, -7.195156036245979, -6.932629285689196, -6.642743186895995, -6.326641516821166, -5.985571858211893, -5.620880687247171, -5.234006680543553, -4.82647664508654, -4.399898910411392, -3.95595691833624, -3.4964026380770745, -3.0230497846698423, -2.5377663636449, -2.0424675416809164, -1.5391080646967101, -1.029674430781822, -0.5161771722677637, -0.0006427827214758145];
  const z = [0.0, 0.13813671087788237, 0.27572837261045496, 0.41223202092565947, 0.5471087489720274, 0.6798262158231249, 0.8098607434900029, 0.9366992636074774, 1.0598411376550285, 1.178800241440484, 1.2931072635167922, 1.402310941429575, 1.505980278155393, 1.6037019498483238, 1.695103126701689, 1.7798087326933993, 1.857491915850647, 1.9278445870608627, 1.9905896570956578, 2.045478931758855, 2.0922960065575795, 2.1308550976107368, 2.161003623685719, 2.1826242153468165, 2.1956312569321037, 2.199973243291585, 2.195633072278772, 2.182627882048078, 2.1610090053751927, 2.1308617601934383, 2.0923051388797926, 2.0454913256870895, 1.9906050717353017, 1.9278629950990225, 1.857512707766828, 1.7798318526452939, 1.6951270088420587, 1.6037324410307519, 1.5060087650459382, 1.4023418334474542, 1.29314062296433, 1.1788362048620133, 1.0598796144636928, 0.9367403213252146, 0.8099043165896072, 0.679872083094989, 0.5471568787724879, 0.41228234564453514, 0.2757808516592869, 0.13819100116757524, 5.584570668196829e-05, -0.1380795054032719, -0.275669966668484, -0.41217252123721415, -0.5470484983882231, -0.6797656255645529, -0.8098001639967257, -0.9366389273261005, -1.059781404812265, -1.1787416344929669, -1.2930501368102183, -1.4022558072078657, -1.5059277285912, -1.6036569546883195, -1.6950572627912164, -1.7797678388374376, -1.8574551190141806, -1.9278122431040707, -1.9905615965165522, -2.0454554147336665, -2.092277140421556, -2.13084188774169, -2.160997584013052, -2.1826250977108246, -2.1956392009007963, -2.199988477085514, -2.195655662752943, -2.1826579184852446, -2.1610465088919635, -2.1309067007342835, -2.092357432972779, -2.0455508196854066, -1.9906715680106668, -1.9279362493280252, -1.8575924185247683, -1.779917672456121, -1.6952184852334413, -1.6038291456463276, -1.50611044089957, -1.4024478632307427, -1.2932505193386095, -1.178949359823306, -1.0599954615605052, -0.936858263286796, -0.8100237484813607, -0.6799924477175151, -0.5472775283601793, -0.412402762999709, -0.27590043219496263, -0.13830925646052544, -0.0001722331111259482];

  const x2 = [10.5, 10.479278853245857, 10.417208600767006, 10.314026967615266, 10.170133828879823, 9.986101165032691, 9.762660544751197, 9.500692410681097, 9.201228830307267, 8.865451371240757, 8.494685737955955, 8.090395350313791, 7.654175562017837, 7.1877492737634165, 6.692957318905224, 6.171751834365059, 5.6261893162102075, 5.058422201983721, 4.470691599681076, 3.86531726239375, 3.244688468924931, 2.61125471391243, 1.9675156901510036, 1.3160118228532522, 0.6593140640696364, 1.4379479830968194e-05, -0.6592852303324022, -1.315982846113624, -1.9674868557042546, -2.61122617879823, -3.2446602794000565, -3.865289287737545, -4.470663861283606, -5.058394693945864, -5.626162491945659, -6.171726110052079, -6.692933002186626, -7.187725727706214, -7.654152012455667, -8.090370944425393, -8.494660816427066, -8.865426641731105, -9.201204311187258, -9.500669686774899, -9.762640012221429, -9.986082094849607, -10.170113789831055, -10.314008581904949, -10.41719929088803, -10.479277488242928, -10.500000274808551, -10.479286191935518, -10.41721803173861, -10.314036625567912, -10.170145225380667, -9.98611809644963, -9.762681807893445, -9.500716439393106, -9.201255175816433, -8.865480140312041, -8.49471680691931, -8.09042781598408, -7.6542100437120055, -7.18778512100785, -6.692993846806903, -6.171788117893571, -5.626224403000416, -5.058455956315066, -4.470723575475224, -3.8653470434999204, -3.2447157432494484, -2.6112789085274914, -1.9675364424188457, -1.3160289263735478, -0.6593275228055265, -2.39919002209208e-05, 0.6592795459939461, 1.3159811105800665, 1.9674889022618882, 2.6112316780310834, 3.244668828972232, 3.8653003643064503, 4.470676867209363, 5.058408953554842, 5.626177036821609, 6.171740379481369, 6.692945470333794, 7.187735840016993, 7.654158003884373, 8.090371937458919, 8.494655362808905, 8.865413223946463, 9.201182030735412, 9.500636376414791, 9.762595046984949, 9.98602306348705, 10.17003987941705, 10.313918067244032, 10.417090729768809, 10.479150070534006, 10.499853075943973];
  const y2 = [0.0, 4.0370501091610676e-17, 8.058171275590146e-17, 1.204749538743411e-16, 1.598927281579158e-16, 1.986794554325255e-16, 2.3668209344442097e-16, 2.73750697296927e-16, 3.0973897018747188e-16, 3.445048547003717e-16, 3.7791112916552524e-16, 4.098259678858171e-16, 4.4012343651590466e-16, 4.686838361635015e-16, 4.953944616651126e-16, 5.201499688892923e-16, 5.428527003210834e-16, 5.634131311275526e-16, 5.817500805568428e-16, 5.977911440859544e-16, 6.114729888054595e-16, 6.227416161153351e-16, 6.31552581360923e-16, 6.378711162147656e-16, 6.41672256512812e-16, 6.42941055811883e-16, 6.416724935473513e-16, 6.378715697942571e-16, 6.315532749472624e-16, 6.227425450442172e-16, 6.114741548514655e-16, 5.977925780984699e-16, 5.817518089810181e-16, 5.634151245175834e-16, 5.428549200656633e-16, 5.201522778061248e-16, 4.953968772666849e-16, 4.686863572195772e-16, 4.401261936906293e-16, 4.098290738370953e-16, 3.7791456040296507e-16, 3.445086296595771e-16, 3.097430657258533e-16, 2.737551231594061e-16, 2.366867826328985e-16, 1.986843697683638e-16, 1.598978452123519e-16, 1.2048028026386316e-16, 8.058725243268752e-17, 4.037617603333124e-17, 5.779876669888764e-21, -4.036463264297675e-17, -8.057576784223244e-17, -1.204689284496603e-16, -1.5988664252688227e-16, -1.9867335674160376e-16, -2.3667602188026156e-16, -2.737446672890303e-16, -3.0973297638660996e-16, -3.4449889979105607e-16, -3.779052261861376e-16, -4.098201736075325e-16, -4.4011764867173945e-16, -4.686780775787182e-16, -4.953887421920606e-16, -5.201443248097681e-16, -5.428471918426819e-16, -5.634077103380792e-16, -5.817447090818063e-16, -5.977857718315803e-16, -6.114675891830524e-16, -6.227361576096741e-16, -6.315470180186702e-16, -6.378654277454672e-16, -6.416664323707622e-16, -6.429350257397541e-16, -6.416662036178977e-16, -6.378649566241689e-16, -6.315462767960416e-16, -6.227351249661606e-16, -6.114662617788925e-16, -5.977841540232428e-16, -5.817428067949231e-16, -5.634054951117614e-16, -5.428446086688697e-16, -5.201413030660312e-16, -4.953851462352268e-16, -4.686739139689384e-16, -4.40112951502785e-16, -4.098150521483916e-16, -3.77899728745798e-16, -3.4449297725208114e-16, -3.097266216316137e-16, -2.7373786540058833e-16, -2.3666877354827454e-16, -1.9866560097755033e-16, -1.598783847841595e-16, -1.2046016524249597e-16, -8.056654365515694e-17, -4.0354948709129106e-17, 1.5882500085981807e-20];
  const z2 = [0.0, 0.6593003161355285, 1.315999238507062, 1.9675053077870344, 2.61124641438232, 3.244681741231082, 3.8653119186561877, 4.470688160660246, 5.058421259143846, 5.626191240449561, 6.171757104638523, 6.6929659746982395, 7.187761186692129, 7.654187909359953, 8.090405527700328, 8.494693641488167, 8.865457382472059, 9.201234699177318, 9.500699809314497, 9.76267025728823, 9.98611173819572, 10.170142387975254, 10.314036370333634, 10.417225875393244, 10.479303207415715, 10.500024272460008, 10.479307078483506, 10.417233282908477, 10.314047697458143, 10.170157558535156, 9.986130781172127, 9.762693676489837, 9.500728036623382, 9.20126725370701, 8.865493633652068, 8.494731348961572, 8.090444977467754, 7.654229081330111, 7.187806214772455, 6.693016698731937, 6.171813140998379, 5.626252890211835, 5.058488144361365, 4.470760440479658, 3.865388498915499, 3.24476199842582, 2.611329982222988, 1.9675922943290822, 1.3160897082944574, 0.6593929949669333, 9.439254916732898e-05, -0.6592044770964288, -1.3159021506991853, -1.9674069051345662, -2.6111470284855067, -3.2445821420501164, -3.8652127624888784, -4.470589683158213, -5.058323372947573, -5.6260939894004425, -6.171660701669493, -6.692871346952942, -7.187666664023976, -7.654093864533766, -8.090312121617186, -8.49460146667477, -8.86536742219305, -9.20114617096718, -9.500612086470225, -9.762582521716409, -9.986023555669995, -10.170053243813008, -10.31394551405991, -10.417132975639777, -10.479208091958066, -10.499925793908936, -10.479204356140261, -10.417125281645053, -10.313933408975686, -10.170036379464545, -9.986001877514845, -9.76255610090111, -9.500581019767692, -9.201109993575821, -8.865325235763077, -8.494552117854369, -8.09025339518525, -7.654025867625691, -7.187589953433305, -6.692787707177681, -6.171570921655287, -5.625997266998682, -5.058219591922525, -4.470478599889854, -3.865094388244141, -3.244455480810865, -2.611012169312476, -1.9672637911007795, -1.3157515082921576, -0.65904632645485, 0.0002593809102800424];


  return (
    <>
    {/* TODO: give this its own header */}
      <h2 style={{position: 'absolute', right: '1%'}}>FOE: Fast Orbit Engine</h2>

      <div className='control-pane'>
          {orbits.length > 0 ? <Orbits orbits={orbits}/> : 'Add an orbit.'}
      </div>

      <div className='view-pane'>
        <Canvas >
          <OrbitTrace xs={x} ys={y} zs={z}/>
          <OrbitTrace xs={x2} ys={y2} zs={z2}/>
          <OrbitControls minDistance={10} maxDistance={75} enablePan={false}/>
          <Stars radius={200} depth={60} count={1000} factor={3} saturation={0.2}/>
          <ambientLight intensity={0.8} />
          <Sphere radius={R_EARTH} />
          <spotLight position={[150, 0, 0]} intensity={3}/>

          <OrbitAnimation xs={x} ys={y} zs={z} color={'navyblue'}/>
          <OrbitAnimation xs={x2} ys={y2} zs={z2} color={'white'}/>
        </Canvas>
      </div>
    </>
  );
}

export default App;